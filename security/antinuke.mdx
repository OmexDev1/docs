---
title: "Antinuke"
description: "Impose restrictions on moderators to prevent destructive behavior."
icon: "fingerprint"
---

## Why use an antinuke system?

An antinuke system helps protect your server from destructive actions performed by moderators/staff—whether intentionally or through a compromised account. It limits how many high-impact actions someone can do within a short time window and automatically responds when that limit is exceeded.

## How does **this** antinuke work?

This system is **audit-log + rate-limit** based.

1. **A server event happens** (e.g. channel created. role deleted. member banned).
2. The bot **reads the Audit Log** to determine **who** performed the action.
3. The bot checks if the actor is **bypassed** (owner/whitelisted).
4. A **ratelimiter** tracks how many actions that actor has done within **10 seconds**.
5. If the actor exceeds the configured **threshold**. AntiNuke:
   - **Logs** an alert to your configured log channel (if enabled)
   - **Punishes** the actor (`ban`. `kick`. or `stripstaff`)
   - **Reverts** what it can (e.g. deletes newly-created channels/roles. reverts permission escalation. deletes mention spam messages)

### What it can and cannot revert

**Can revert:**

- Channel creation (it deletes the created channel after trigger)
- Role creation (it deletes the created role after trigger)
- Dangerous permission escalation on roles (it edits permissions back)
- Dangerous roles granted to members (it removes the roles)
- Mention spam (it deletes cached messages in the last 10 seconds)
- Webhook abuse (it can delete webhooks if it has permission)

**Cannot reliably revert:**

- Channel deletions (Discord does not provide a true restore)
- Role deletions (same limitation)

AntiNuke will still **punish and log** the actor for deletions.

---

## Requirements

### Bot permissions (important)

AntiNuke relies heavily on audit logs and moderation permissions. Recommended permissions:

- **View Audit Log** _(required for most modules to function)_
- **Ban Members** _(if you use ban punishment)_
- **Kick Members** _(if you use kick punishment)_
- **Manage Roles** _(required for stripstaff + reverting perms + removing dangerous roles)_
- **Manage Channels** _(required to delete channels it created / clean up)_
- **Manage Webhooks** _(required to remove abusive webhooks)_
- **Read Message History** _(for mention spam deletion)_
- **Manage Messages** _(helps with deleting mention messages)_

> If your bot does not have a required permission. that module may silently fail to punish/revert.

---

## Quick setup

1. Invite the bot with the permissions above.
2. Enable Antinuke: `.antinuke on`
3. Set a log channel: `.antinuke logchannel #logs`
4. Add trusted Antinuke admins (optional): `.antinuke admin @user`
5. Configure modules (recommended set below).
6. Verify config: `.antinuke configuration`

---

## Core commands

### Enable AntiNuke (server owner only)

<CodeGroup>

```javascript Syntax
.antinuke on
```


```javascript Example
.antinuke on
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/on.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

### Disable AntiNuke (server owner only)

This disables AntiNuke and resets the stored configuration.

<CodeGroup>

```javascript Syntax
.antinuke off
```


```javascript Example
.antinuke off
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/off.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

### Set the log channel (server owner only)

<CodeGroup>

```javascript Syntax
.antinuke logchannel (#channel)
```


```javascript Example
.antinuke logchannel #security-logs
```

</CodeGroup>

#### Disable logging

<CodeGroup>

```javascript Syntax
.antinuke logchannel
```


```javascript Example
.antinuke logchannel
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/logchannel.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

---

## Admins and bypassing

### Allowing other users to configure AntiNuke (server owner only)

The server owner can toggle AntiNuke Admin on a member.

<Warning>
  This is dangerous. AntiNuke Admins can alter protections and reduce thresholds.
</Warning>

<CodeGroup>

```javascript Syntax
.antinuke admin (user)
```


```javascript Example
.antinuke admin @aj.wtf
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/admin.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

### Viewing AntiNuke Admins (server owner only)

<CodeGroup>

```javascript Syntax
.antinuke admins
```


```javascript Example
.antinuke admins
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/admins.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

### Whitelisting (bypass AntiNuke)

Whitelisted users do not trigger antinuke punishments.

<Warning>
  Dangerous: this bypasses ALL modules.
</Warning>

<CodeGroup>

```javascript Syntax
.antinuke whitelist (user)
```


```javascript Example
.antinuke whitelist @jonathan
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/wl.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

#### Unwhitelist

<CodeGroup>

```javascript Syntax
.antinuke unwhitelist (user)
```


```javascript Example
.antinuke unwhitelist @jonathan
```

</CodeGroup>

#### View whitelisted users

<CodeGroup>

```javascript Syntax
.antinuke whitelisted
```


```javascript Example
.antinuke whitelisted
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/whitelisted.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

---

## Enabling an antinuke module

Modules are configured per feature (ban/kick/channelcreation/etc). Each module is stored with:

- `status` (on/off)
- `punishment` (`ban`. `kick`. `stripstaff`)
- `threshold` (1–12)
- `command` (true/false) _(stored; your listeners are audit-log based)_

### Available Flags

<AccordionGroup>
  <Accordion title="Threshold">
    Number of actions allowed in a **10 second** window before AntiNuke triggers.

    <Info>
      Recommended:

      - **1–2** for destructive actions (deletions. dangerous permissions)
      - **2–4** for creation spam (channels/roles)
      - **3–5** for mentions
    </Info>
    <CodeGroup>

    ```javascript Syntax
    --threshold (number)
    ```

    
    ```javascript Example
    --threshold 3
    ```

    </CodeGroup>
  </Accordion>
  <Accordion title="Punishment">
    Action taken against the actor when the module triggers.

    <Info>
      Punishments:

      - `ban`
      - `kick`
      - `stripstaff` (removes staff roles the bot is allowed to remove)
    </Info>
    <CodeGroup>

    ```javascript Syntax
    --do (punishment)
    ```

    
    ```javascript Example
    --do stripstaff
    ```

    </CodeGroup>
  </Accordion>
  <Accordion title="Command detection">
    Stored in configuration as `command: true/false`.

    <Info>
      In this code. triggers rely on audit logs and events. not command parsing. Keep it enabled for consistency with your config schema.
    </Info>
    <CodeGroup>

    ```javascript Syntax
    --command (true | false)
    ```

    
    ```javascript Example
    --command true
    ```

    </CodeGroup>
  </Accordion>
</AccordionGroup>

---

````mdx
## Enabling an antinuke module

Modules are configured per feature (ban/kick/channelcreation/etc). Each module is stored with:

- `status` (on/off)
- `punishment` (`ban`. `kick`. `stripstaff`)
- `threshold` (1–12)
- `command` (true/false) *(stored; your listeners are audit-log based)*

### Available Flags

<AccordionGroup>
  <Accordion title="Threshold">
    Number of actions allowed in a **10 second** window before AntiNuke triggers.

    <Info>
      Recommended:
      - **1–2** for destructive actions (deletions. dangerous permissions)
      - **2–4** for creation spam (channels/roles)
      - **3–5** for mentions
    </Info>

    <CodeGroup>
      ```javascript Syntax
      --threshold (number)
      ```

      ```javascript Example
      --threshold 3
      ```
    </CodeGroup>
  </Accordion>

  <Accordion title="Punishment">
    Action taken against the actor when the module triggers.

    <Info>
      Punishments:
      - `ban`
      - `kick`
      - `stripstaff` (removes staff roles the bot is allowed to remove)
    </Info>

    <CodeGroup>
      ```javascript Syntax
      --do (punishment)
      ```

      ```javascript Example
      --do stripstaff
      ```
    </CodeGroup>
  </Accordion>

  <Accordion title="Command detection">
    Stored in configuration as `command: true/false`.

    <Info>
      In this code. triggers rely on audit logs and events. not command parsing.
      Keep it enabled for consistency with your config schema.
    </Info>

    <CodeGroup>
      ```javascript Syntax
      --command (true | false)
      ```

      ```javascript Example
      --command true
      ```
    </CodeGroup>
  </Accordion>
</AccordionGroup>

---

## Modules (exactly matching your code)

<AccordionGroup>
  <Accordion title="Mass ban">
    Triggers on `on_member_ban` and checks audit logs for who banned.

    <CodeGroup>
      ```javascript Syntax
      .antinuke ban (on or off) --threshold (number) --do (punishment) --command (true | false)
      ```

      ```javascript Example
      .antinuke ban on --threshold 3 --do ban --command true
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Mass kick">
    Triggers on `on_member_remove` and checks audit logs for kick actions.

    <CodeGroup>
      ```javascript Syntax
      .antinuke kick (on or off) --threshold (number) --do (punishment) --command (true | false)
      ```

      ```javascript Example
      .antinuke kick on --threshold 3 --do ban --command true
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Channel creation">
    Triggers on `on_guild_channel_create`. If it triggers. it punishes the actor and deletes the created channel.

    <CodeGroup>
      ```javascript Syntax
      .antinuke channelcreation (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke channelcreation on --threshold 2 --do stripstaff
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Channel deletion">
    Triggers on `on_guild_channel_delete`. Punishes/logs on threshold.

    <Warning>
      Deleted channels cannot be automatically restored.
    </Warning>

    <CodeGroup>
      ```javascript Syntax
      .antinuke channeldeletion (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke channeldeletion on --threshold 1 --do ban
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Role creation">
    Triggers on `on_guild_role_create`. If it triggers. it punishes the actor and deletes the created role.

    <CodeGroup>
      ```javascript Syntax
      .antinuke rolecreation (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke rolecreation on --threshold 2 --do stripstaff
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Role deletion">
    Triggers on `on_guild_role_delete`. Punishes/logs on threshold.

    <Warning>
      Deleted roles cannot be automatically restored.
    </Warning>

    <CodeGroup>
      ```javascript Syntax
      .antinuke roledeletion (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke roledeletion on --threshold 1 --do ban
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Webhooks">
    Triggers on `on_webhooks_update`. Looks for webhook create/delete/update in audit logs.
    If it triggers and the bot has `Manage Webhooks`. it deletes webhooks in that channel.

    <CodeGroup>
      ```javascript Syntax
      .antinuke webhooks (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke webhooks on --threshold 1 --do ban
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Mass mentions">
    Triggers on `on_message`. Counts mentions in each message:
    - `@everyone/@here` adds **5**
    - user mentions add **1 each**
    - role mentions add **1 each**

    If the message includes any mentions. it caches the message ID.
    When threshold triggers. it deletes cached mention messages from the last 10 seconds and punishes/logs.

    <CodeGroup>
      ```javascript Syntax
      .antinuke mentions (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke mentions on --threshold 3 --do stripstaff
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>

  <Accordion title="Dangerous permissions">
    This module covers TWO cases:

    **1) Role permission escalation**
    - Event: `on_guild_role_update(before. after)`
    - If dangerous permissions were ADDED. it finds who did it via audit logs.
    - If threshold triggers. it reverts the role permissions back to `before.permissions` and punishes/logs.

    **2) Dangerous role granted to a member**
    - Event: `on_member_update(before. after)`
    - Detects newly added roles on the member.
    - If any added role has dangerous permissions. it finds the actor via audit logs.
    - If threshold triggers. it removes the dangerous roles from the target member and punishes/logs.

    <CodeGroup>
      ```javascript Syntax
      .antinuke permissions (on or off) --threshold (number) --do (punishment)
      ```

      ```javascript Example
      .antinuke permissions on --threshold 1 --do ban
      ```
    </CodeGroup>

    {/* images removed from Modules section */}
  </Accordion>
</AccordionGroup>

---

## Viewing configuration

Shows AntiNuke enabled status + each module state and parameters.

<CodeGroup>
  ```javascript Syntax
  .antinuke configuration
````

```javascript Example
.antinuke configuration
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/config.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>
```


## Viewing configuration

Shows AntiNuke enabled status + each module state and parameters.

<CodeGroup>

```javascript Syntax
.antinuke configuration
```


```javascript Example
.antinuke configuration
```

</CodeGroup>

<br />

<Frame>
  <img
    src="/images/security/antinuke/config.png"
    alt=""
    style={{ width:"100%" }}
  />
</Frame>

---

## Troubleshooting

### Nothing triggers

- Ensure the bot has **View Audit Log**
- Ensure AntiNuke is enabled: `.antinuke configuration`
- Ensure the specific module is enabled (shows ✅)
- Ensure the bot’s role is high enough to punish/remove roles
- Check your log channel is set properly

### stripstaff doesn’t work

- Bot must have **Manage Roles**
- Bot’s highest role must be **above** the roles it is attempting to remove

### mentions module doesn’t work

- Ensure **Message Content** intent is enabled
- Ensure the bot can read messages in the channels
- Ensure the module is enabled: `.antinuke mentions on ...`

---

## Dangerous permissions tracked in code

These permission keys are treated as “dangerous”:

| Dangerous Permission Keys |
| ------------------------- |
| `administrator`           |
| `manage_guild`            |
| `manage_roles`            |
| `manage_channels`         |
| `manage_webhooks`         |
| `ban_members`             |
| `kick_members`            |
| `mention_everyone`        |
| `moderate_members`        |
| `manage_nicknames`        |